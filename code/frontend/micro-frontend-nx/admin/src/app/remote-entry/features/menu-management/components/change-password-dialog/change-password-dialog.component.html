<div class="fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 backdrop-blur-md px-4"
    (click)="onCancel()">
    <div class="w-full max-w-lg bg-white dark:bg-slate-800 rounded-2xl shadow-2xl border border-slate-100 dark:border-slate-800 overflow-hidden transform transition-all"
        (click)="$event.stopPropagation()">
        <!-- Header -->
        <div class="px-8 pt-8 pb-4">
            <div class="flex justify-between items-center mb-1">
                <h2 class="text-2xl font-extrabold text-slate-900 dark:text-white tracking-tight">Đổi mật khẩu bảo mật
                </h2>
                <button (click)="onCancel()"
                    class="text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition-colors">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
            <p class="text-slate-500 dark:text-slate-400 text-sm">Thiết lập mật khẩu mới cho tài khoản của bạn.</p>
        </div>

        <!-- Form -->
        <form class="px-8 py-4 space-y-5" (submit)="onSubmit(); $event.preventDefault()">
            <!-- Current Password -->
            <div>
                <label class="block text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-2"
                    for="current-password">Mật khẩu hiện tại</label>
                <div class="relative">
                    <input [(ngModel)]="currentPassword" name="currentPassword"
                        [type]="showCurrentPassword() ? 'text' : 'password'"
                        class="w-full pl-4 pr-12 py-3 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-primary/20 dark:focus:ring-emerald-500/20 focus:border-primary dark:focus:border-emerald-500 transition-all dark:text-white outline-none text-sm"
                        id="current-password" placeholder="••••••••" />
                    <button type="button" (click)="toggleCurrentPassword()"
                        class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 transition-colors">
                        <span class="material-symbols-outlined text-xl">{{ showCurrentPassword() ? 'visibility_off' :
                            'visibility' }}</span>
                    </button>
                </div>
            </div>

            <!-- New Password -->
            <div>
                <label class="block text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-2"
                    for="new-password">Mật khẩu mới</label>
                <div class="relative">
                    <input [(ngModel)]="newPassword" name="newPassword" [type]="showNewPassword() ? 'text' : 'password'"
                        class="w-full pl-4 pr-12 py-3 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-primary/20 dark:focus:ring-emerald-500/20 focus:border-primary dark:focus:border-emerald-500 transition-all dark:text-white outline-none text-sm"
                        id="new-password" placeholder="Nhập mật khẩu mới" />
                    <button type="button" (click)="toggleNewPassword()"
                        class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 transition-colors">
                        <span class="material-symbols-outlined text-xl">{{ showNewPassword() ? 'visibility_off' :
                            'visibility' }}</span>
                    </button>
                </div>

                <!-- Strength Bar -->
                <div class="mt-3" *ngIf="newPassword">
                    <div class="flex gap-1 mb-2">
                        <!-- Simplified visual representation of strength -->
                        <div class="strength-bar flex-1 h-1 rounded-full transition-all duration-300"
                            [class]="passwordStrength >= 1 ? strengthColorClass : 'bg-slate-200 dark:bg-slate-700'">
                        </div>
                        <div class="strength-bar flex-1 h-1 rounded-full transition-all duration-300"
                            [class]="passwordStrength >= 2 ? strengthColorClass : 'bg-slate-200 dark:bg-slate-700'">
                        </div>
                        <div class="strength-bar flex-1 h-1 rounded-full transition-all duration-300"
                            [class]="passwordStrength >= 3 ? strengthColorClass : 'bg-slate-200 dark:bg-slate-700'">
                        </div>
                        <div class="strength-bar flex-1 h-1 rounded-full transition-all duration-300"
                            [class]="passwordStrength >= 4 ? strengthColorClass : 'bg-slate-200 dark:bg-slate-700'">
                        </div>
                    </div>
                    <p class="text-[10px] font-bold text-slate-400 flex items-center gap-1 uppercase tracking-tight">
                        <span class="material-symbols-outlined !text-[14px]"
                            [class]="strengthTextClass">check_circle</span>
                        Độ mạnh: <span [class]="strengthTextClass">{{ strengthLabel }}</span>
                    </p>
                </div>
            </div>

            <!-- Confirm Password -->
            <div>
                <label class="block text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-2"
                    for="confirm-password">Xác nhận mật khẩu</label>
                <div class="relative">
                    <input [(ngModel)]="confirmPassword" name="confirmPassword"
                        [type]="showConfirmPassword() ? 'text' : 'password'"
                        class="w-full pl-4 pr-12 py-3 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-primary/20 dark:focus:ring-emerald-500/20 focus:border-primary dark:focus:border-emerald-500 transition-all dark:text-white outline-none text-sm"
                        id="confirm-password" placeholder="Nhập lại mật khẩu mới" />
                    <button type="button" (click)="toggleConfirmPassword()"
                        class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 transition-colors">
                        <span class="material-symbols-outlined text-xl">{{ showConfirmPassword() ? 'visibility_off' :
                            'visibility' }}</span>
                    </button>
                </div>
            </div>

            <!-- Validation Info -->
            <div class="bg-slate-50 dark:bg-slate-900/50 rounded-xl p-4 border border-slate-100 dark:border-slate-800">
                <p class="text-[10px] font-bold text-slate-500 dark:text-slate-400 mb-2 uppercase tracking-widest">Yêu
                    cầu bảo mật:</p>
                <ul class="text-[11px] text-slate-600 dark:text-slate-400 space-y-1.5">
                    <li class="flex items-center gap-2" [class.text-green-600]="newPassword.length >= 8">
                        <span class="w-1 h-1 rounded-full bg-primary/40 dark:bg-emerald-500/40"
                            [class.bg-green-500]="newPassword.length >= 8"></span> Tối thiểu 8 ký tự
                    </li>
                    <li class="flex items-center gap-2" [class.text-green-600]="passwordStrength >= 3">
                        <!-- Approximation -->
                        <span class="w-1 h-1 rounded-full bg-primary/40 dark:bg-emerald-500/40"
                            [class.bg-green-500]="passwordStrength >= 3"></span> Chứa chữ cái và số
                    </li>
                </ul>
            </div>

            <!-- Actions -->
            <div
                class="px-8 py-6 -mx-8 -mb-4 bg-slate-50 dark:bg-slate-900/30 border-t border-slate-100 dark:border-slate-800 flex justify-end items-center gap-3">
                <button type="button" (click)="onCancel()"
                    class="px-6 py-2.5 text-sm font-bold text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-xl transition-all">
                    Hủy bỏ
                </button>
                <button type="submit"
                    class="px-6 py-2.5 bg-primary dark:bg-emerald-600 text-white text-sm font-bold rounded-xl shadow-lg shadow-primary/20 dark:shadow-emerald-500/20 hover:opacity-90 active:scale-95 transition-all flex items-center gap-2">
                    Cập nhật mật khẩu
                </button>
            </div>
        </form>
    </div>
</div>